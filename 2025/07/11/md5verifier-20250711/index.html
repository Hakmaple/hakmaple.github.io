<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        
            How to design an MD5 verifier | zer0ptr&#39;s Blog
        
    </title>
    
    <!-- Meta tags -->
    <meta name="description" content="">
    <meta name="author" content="zer0ptr">
    
    <!-- å…³é”®CSSå†…è” -->
    <style>
        /* å…³é”®æ¸²æŸ“è·¯å¾„CSS */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6; color: #333; background-color: #fff; font-size: 17px; overflow-x: hidden;
        }
        .container { max-width: 650px; margin: 0 auto; padding: 0 15px; }
        .loading-indicator {
            position: fixed; top: 0; left: 0; width: 100%; height: 3px;
            background: linear-gradient(90deg, #007acc, #4fc3f7);
            transform: translateX(-100%); transition: transform 0.3s ease; z-index: 9999;
        }
        .loading-indicator.active { animation: loadingProgress 1s ease-in-out infinite; }
        @keyframes loadingProgress {
            0% { transform: translateX(-100%); }
            50% { transform: translateX(0%); }
            100% { transform: translateX(100%); }
        }
    </style>
    
    <!-- å¼‚æ­¥åŠ è½½å®Œæ•´CSS -->
    <link rel="preload" href="/css/style.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/css/style.css"></noscript>
    
    <!-- CSSåŠ è½½polyfill -->
    <script>
        // ç¡®ä¿CSSå¼‚æ­¥åŠ è½½åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­æ­£å¸¸å·¥ä½œ
        !function(e){"use strict";var t=function(t,n,r){function o(e){return i.body?e():void setTimeout(function(){o(e)})}function a(){d.addEventListener&&d.removeEventListener("load",a),d.media=r||"all"}var i=e.document,d=i.createElement("link");if(n)d.id=n;d.rel="stylesheet",d.href=t,d.media="only x",o(function(){i.head.appendChild(d)}),setTimeout(a);return d};e.loadCSS=t}(this);
    </script>
    
    <!-- é¢„åŠ è½½å…³é”®èµ„æº -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    
    <!-- æŒ‰éœ€åŠ è½½Highlight.js CSS -->
    
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    
    
    <!-- æŒ‰éœ€åŠ è½½MathJax -->
    
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- é¢„åŠ è½½JavaScript -->
    <link rel="preload" href="/js/search.js" as="script">
    <link rel="preload" href="/js/script.js" as="script">
<meta name="generator" content="Hexo 7.3.0"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head>
<body>
    <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
    <div class="loading-indicator" id="loadingIndicator"></div>
    <!-- Top Navigation Bar -->
    
    <nav class="top-navigation">
        <div class="container">
            <div class="nav-brand">
                <a href="/" class="nav-brand-link">
                    zer0ptr&#39;s blog
                </a>
            </div>
            <ul class="top-nav-list">
                
                    <li class="top-nav-item">
                        <a href="/archives" class="top-nav-link">
                            Archives
                        </a>
                    </li>
                
                    <li class="top-nav-item">
                        <a href="/categories" class="top-nav-link">
                            Categories
                        </a>
                    </li>
                
                    <li class="top-nav-item">
                        <a href="/tags" class="top-nav-link">
                            Tags
                        </a>
                    </li>
                
                    <li class="top-nav-item">
                        <a href="/about" class="top-nav-link">
                            About
                        </a>
                    </li>
                
                <li class="top-nav-item">
                    <a href="https://github.com" class="top-nav-link" target="_blank">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                        </svg>
                    </a>
                </li>
                <li class="top-nav-item">
                    <a href="#" class="top-nav-link search-toggle">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                        </svg>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
    
    
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="site-title">
                    <a href="/">
                        zer0ptr&#39;s blog
                    </a>
                </h1>
                
                    <p class="site-subtitle">
                        Walking on my wayğŸ§.
                    </p>
                
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content page-transition" id="mainContent">
            <article class="post">
    <!-- Post Header -->
    <header class="post-header">
        
            <div class="post-meta">
                
                    <a href="/categories/Coding/" class="category-link">
                        Coding
                    </a>
                
            </div>
        
        
        <h1 class="post-title">How to design an MD5 verifier</h1>
        
        <div class="post-info">
            <time class="post-date" datetime="2025-07-11T07:09:03.000Z">
                July 11, 2025
            </time>
            
            
            
            
        </div>
        
        
            <div class="post-tags">
                
                    <a href="/tags/Coding/" class="tag-link">
                        #Coding
                    </a>
                
            </div>
        
    </header>
    
    <!-- Post Content -->
    <div class="post-content">
        <p>é¡¹ç›®åœ°å€ï¼š<em><a target="_blank" rel="noopener" href="https://github.com/fishcanf1y/MD5-Checker">https://github.com/fishcanf1y/MD5-Checker</a></em></p>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description:"></a>Description:</h2><p>MD5 æ ¡éªŒå™¨ç”¨äºéªŒè¯æ•°æ®å®Œæ•´æ€§å’Œæ£€æµ‹æ•°æ®æ˜¯å¦è¢«ç¯¡æ”¹ï¼Œå¸¸ç”¨äºæ–‡ä»¶ä¸‹è½½ã€è½¯ä»¶æ›´æ–°ã€å¯†ç å­˜å‚¨ç­‰åœºæ™¯ã€‚å®ƒå¯ä»¥å¿«é€Ÿç”Ÿæˆæ–‡ä»¶çš„â€œæ•°å­—æŒ‡çº¹â€â€”â€”MD5 å€¼ï¼Œç„¶åå°†è¯¥å€¼ä¸åŸå§‹å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®ä¿æ–‡ä»¶åœ¨ä¼ è¾“æˆ–å­˜å‚¨è¿‡ç¨‹ä¸­æ²¡æœ‰å‘ç”Ÿå˜åŒ–ã€‚ï»¿</p>
<p>ä»¥ä¸‹æ˜¯MD5 æ ¡éªŒå™¨çš„ä¸»è¦ç”¨é€”å’Œä¼˜åŠ¿ï¼š</p>
<ul>
<li><p><strong>æ–‡ä»¶å®Œæ•´æ€§éªŒè¯:</strong></p>
<p>å½“ä¸‹è½½æ–‡ä»¶æ—¶ï¼Œç½‘ç«™é€šå¸¸ä¼šæä¾›æ–‡ä»¶çš„MD5 å€¼ã€‚ä¸‹è½½å®Œæˆåï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨MD5 æ ¡éªŒå™¨è®¡ç®—ä¸‹è½½æ–‡ä»¶çš„MD5 å€¼ï¼Œå¹¶ä¸æä¾›çš„MD5 å€¼è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœä¸¤è€…ä¸€è‡´ï¼Œåˆ™è¡¨ç¤ºæ–‡ä»¶æ²¡æœ‰æŸåæˆ–è¢«ç¯¡æ”¹ï¼›å¦‚æœä¸ä¸€è‡´ï¼Œåˆ™è¡¨ç¤ºæ–‡ä»¶å¯èƒ½æŸåæˆ–è¢«æ¶æ„ä¿®æ”¹ï¼Œéœ€è¦é‡æ–°ä¸‹è½½ã€‚ï»¿</p>
</li>
<li><p><strong>æ•°æ®ä¸€è‡´æ€§éªŒè¯:</strong></p>
<p>åœ¨æ•°æ®ä¼ è¾“å’Œå­˜å‚¨è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°é”™è¯¯æˆ–å¹²æ‰°å¯¼è‡´æ•°æ®æŸåã€‚é€šè¿‡å¯¹æ•°æ®è¿›è¡ŒMD5 æ ¡éªŒï¼Œå¯ä»¥ç¡®ä¿æ•°æ®åœ¨ä¸åŒèŠ‚ç‚¹ä¹‹é—´çš„ä¸€è‡´æ€§ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±æˆ–æŸåã€‚ï»¿</p>
</li>
<li><p><strong>å®‰å…¨æ€§ä¿æŠ¤:</strong></p>
<p>MD5 æ ¡éªŒå¯ä»¥ç”¨äºæ£€æµ‹æ¶æ„ç¯¡æ”¹ã€‚å¦‚æœæ–‡ä»¶åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«æ¶æ„ç¯¡æ”¹ï¼Œå…¶MD5 å€¼ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä»è€Œå¯ä»¥åŠæ—¶å‘ç°å¹¶é˜»æ­¢æ¶æ„è¡Œä¸ºã€‚ï»¿</p>
</li>
<li><p><strong>æ–‡ä»¶è¯†åˆ«å’Œé‡å¤æ€§æ£€æµ‹:</strong></p>
<p>æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„MD5 å€¼ï¼Œå¯ä»¥ç”¨äºå¿«é€Ÿè¯†åˆ«æ–‡ä»¶ï¼Œé¿å…å­˜å‚¨å’Œä¼ è¾“é‡å¤æ–‡ä»¶ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´å’Œå¸¦å®½ã€‚ï»¿</p>
</li>
<li><p><strong>å¯†ç å­˜å‚¨:</strong></p>
<p>è™½ç„¶MD5 ç®—æ³•ä¸å†è¢«æ¨èç”¨äºç›´æ¥å­˜å‚¨å¯†ç ï¼Œä½†å®ƒä»ç„¶è¢«å¹¿æ³›ç”¨äºå­˜å‚¨å¯†ç çš„å“ˆå¸Œå€¼ã€‚è¿™æ ·å³ä½¿æ•°æ®åº“æ³„éœ²ï¼Œæ”»å‡»è€…ä¹Ÿæ— æ³•ç›´æ¥è·å–ç”¨æˆ·çš„æ˜æ–‡å¯†ç ã€‚</p>
</li>
</ul>
<p>ï»¿</p>
<p>æ€»è€Œè¨€ä¹‹ï¼ŒMD5 æ ¡éªŒå™¨åœ¨ä¿è¯æ•°æ®å®‰å…¨å’Œå®Œæ•´æ€§æ–¹é¢å‘æŒ¥ç€é‡è¦ä½œç”¨ï¼Œå°¤å…¶æ˜¯åœ¨æ–‡ä»¶ä¼ è¾“ã€æ•°æ®å­˜å‚¨å’Œå¯†ç ç®¡ç†ç­‰åœºæ™¯ä¸­ã€‚ï»¿</p>
<h2 id="How-To-Do"><a href="#How-To-Do" class="headerlink" title="How To Do?"></a>How To Do?</h2><p>ä»¥ä¸‹æˆ‘å°†æ¢³ç†å¤§è‡´æ€è·¯å¹¶åˆ—ä¸¾ä¸€äº›ä»£ç ç‰‡æ®µæ¥è¯´æ˜å…¶ä½œç”¨</p>
<h3 id="ä¸€ã€æ ¸å¿ƒç›®æ ‡"><a href="#ä¸€ã€æ ¸å¿ƒç›®æ ‡" class="headerlink" title="ä¸€ã€æ ¸å¿ƒç›®æ ‡"></a>ä¸€ã€æ ¸å¿ƒç›®æ ‡</h3><ol>
<li><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š<ul>
<li>è®¡ç®—æ–‡ä»¶çš„MD5å“ˆå¸Œå€¼ï¼ˆæ–‡ä»¶å®Œæ•´æ€§æŒ‡çº¹ï¼‰</li>
<li>éªŒè¯æ–‡ä»¶æ˜¯å¦ä¸é¢„æœŸMD5åŒ¹é…</li>
<li>æ”¯æŒæ‰¹é‡å¤„ç†å’Œç›®å½•é€’å½’æ“ä½œ</li>
</ul>
</li>
<li><strong>éåŠŸèƒ½æ€§éœ€æ±‚</strong>ï¼š<ul>
<li>å†…å­˜å®‰å…¨ï¼ˆæ”¯æŒå¤§æ–‡ä»¶å¤„ç†ï¼‰</li>
<li>è·¨å¹³å°å…¼å®¹æ€§ï¼ˆWindows&#x2F;Linux&#x2F;macOSï¼‰</li>
<li>ç¬¦åˆæ ‡å‡†å·¥å…·è¡Œä¸ºï¼ˆå…¼å®¹<code>md5sum</code>æ ¼å¼ï¼‰</li>
</ul>
</li>
</ol>
<h3 id="äºŒã€å…³é”®å®ç°æ€è·¯"><a href="#äºŒã€å…³é”®å®ç°æ€è·¯" class="headerlink" title="äºŒã€å…³é”®å®ç°æ€è·¯"></a>äºŒã€å…³é”®å®ç°æ€è·¯</h3><h4 id="1-æ–‡ä»¶å“ˆå¸Œè®¡ç®—ï¼ˆæ ¸å¿ƒç®—æ³•ï¼‰"><a href="#1-æ–‡ä»¶å“ˆå¸Œè®¡ç®—ï¼ˆæ ¸å¿ƒç®—æ³•ï¼‰" class="headerlink" title="1. æ–‡ä»¶å“ˆå¸Œè®¡ç®—ï¼ˆæ ¸å¿ƒç®—æ³•ï¼‰"></a>1. æ–‡ä»¶å“ˆå¸Œè®¡ç®—ï¼ˆæ ¸å¿ƒç®—æ³•ï¼‰</h4><p><strong>è®¾è®¡è¦ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>åˆ†å—å¤„ç†</strong>ï¼šé¿å…å†…å­˜æº¢å‡º</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_md5</span>(<span class="params">file_path, block_size=<span class="number">65536</span></span>):</span><br><span class="line">    md5 = hashlib.md5()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> block <span class="keyword">in</span> <span class="built_in">iter</span>(<span class="keyword">lambda</span>: f.read(block_size), <span class="string">b&#x27;&#x27;</span>):</span><br><span class="line">            md5.update(block)  <span class="comment"># å¢é‡æ›´æ–°å“ˆå¸Œ</span></span><br><span class="line">    <span class="keyword">return</span> md5.hexdigest()</span><br></pre></td></tr></table></figure>

<ul>
<li><p>ä½¿ç”¨ç”Ÿæˆå™¨æ¨¡å¼é€å—è¯»å–ï¼ˆ<code>iter+lambda</code>æŠ€å·§ï¼‰</p>
</li>
<li><p>é»˜è®¤64KBå—å¤§å°å¹³è¡¡I&#x2F;Oæ•ˆç‡å’Œå†…å­˜å ç”¨</p>
</li>
<li><p><strong>é”™è¯¯å¤„ç†</strong>ï¼š</p>
<ul>
<li>æ•è·<code>IOError</code>å¹¶è¿”å›<code>None</code>ç»Ÿä¸€è¡¨ç¤ºå¤±è´¥</li>
<li>äºŒè¿›åˆ¶æ¨¡å¼(<code>&#39;rb&#39;</code>)ç¡®ä¿è·¨å¹³å°ä¸€è‡´æ€§</li>
</ul>
</li>
</ul>
<h4 id="2-éªŒè¯æœºåˆ¶"><a href="#2-éªŒè¯æœºåˆ¶" class="headerlink" title="2. éªŒè¯æœºåˆ¶"></a>2. éªŒè¯æœºåˆ¶</h4><p><strong>è®¾è®¡è¦ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>å¤§å°å†™ä¸æ•æ„Ÿ</strong>ï¼š<code>.lower()</code>å¤„ç†ç”¨æˆ·è¾“å…¥</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> actual_md5.lower() == expected_md5.lower()</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>æ˜ç¡®è¾“å‡º</strong>ï¼šæ ¼å¼åŒ–æ˜¾ç¤ºé¢„æœŸ&#x2F;å®é™…å€¼å¯¹æ¯”</p>
</li>
<li><p><strong>è¿”å›å¸ƒå°”å€¼</strong>ï¼šä¾¿äºè„šæœ¬åŒ–è°ƒç”¨</p>
</li>
</ul>
<h4 id="3-æ‰¹é‡å¤„ç†"><a href="#3-æ‰¹é‡å¤„ç†" class="headerlink" title="3. æ‰¹é‡å¤„ç†"></a>3. æ‰¹é‡å¤„ç†</h4><p><strong>é€’å½’ç›®å½•å¤„ç†</strong>ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> root, _, files <span class="keyword">in</span> os.walk(directory):</span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> files:</span><br><span class="line">        file_path = os.path.join(root, filename)</span><br><span class="line">        relative_path = os.path.relpath(file_path, directory)</span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿ç”¨<code>os.walk</code>å®ç°æ·±åº¦ä¼˜å…ˆéå†</li>
<li><code>os.path.relpath</code>ç”Ÿæˆç›¸å¯¹è·¯å¾„ä¿è¯æ ¡éªŒæ–‡ä»¶å¯ç§»æ¤æ€§</li>
</ul>
<h4 id="4-å‘½ä»¤è¡Œæ¥å£"><a href="#4-å‘½ä»¤è¡Œæ¥å£" class="headerlink" title="4. å‘½ä»¤è¡Œæ¥å£"></a>4. å‘½ä»¤è¡Œæ¥å£</h4><p><strong>å­å‘½ä»¤æ¨¡å¼</strong>ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">subparsers = parser.add_subparsers(dest=<span class="string">&#x27;command&#x27;</span>)</span><br><span class="line">calc_parser = subparsers.add_parser(<span class="string">&#x27;calc&#x27;</span>)</span><br><span class="line">verify_parser = subparsers.add_parser(<span class="string">&#x27;verify&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ†ç¦»<code>calc</code>å’Œ<code>verify</code>é€»è¾‘</li>
<li>è‡ªåŠ¨ç”Ÿæˆå¸®åŠ©ä¿¡æ¯ï¼ˆ<code>-h</code>ï¼‰</li>
</ul>
<hr>
<h3 id="ä¸‰ã€å…¸å‹å·¥ä½œæµç¨‹"><a href="#ä¸‰ã€å…¸å‹å·¥ä½œæµç¨‹" class="headerlink" title="ä¸‰ã€å…¸å‹å·¥ä½œæµç¨‹"></a>ä¸‰ã€å…¸å‹å·¥ä½œæµç¨‹</h3><h4 id="åœºæ™¯1ï¼šå•æ–‡ä»¶éªŒè¯"><a href="#åœºæ™¯1ï¼šå•æ–‡ä»¶éªŒè¯" class="headerlink" title="åœºæ™¯1ï¼šå•æ–‡ä»¶éªŒè¯"></a>åœºæ™¯1ï¼šå•æ–‡ä»¶éªŒè¯</h4><p><img src="/images/verifier_1_20250712.png" alt="å•æ–‡ä»¶éªŒè¯"></p>
<h4 id="åœºæ™¯2ï¼šç”ŸæˆéªŒè¯æ–‡ä»¶"><a href="#åœºæ™¯2ï¼šç”ŸæˆéªŒè¯æ–‡ä»¶" class="headerlink" title="åœºæ™¯2ï¼šç”ŸæˆéªŒè¯æ–‡ä»¶"></a>åœºæ™¯2ï¼šç”ŸæˆéªŒè¯æ–‡ä»¶</h4><p><img src="/images/verifier_2_20250712.png" alt="ç”ŸæˆéªŒè¯æ–‡ä»¶"></p>
<h3 id="å››ã€æ‰©å±•è®¾è®¡æ€è·¯"><a href="#å››ã€æ‰©å±•è®¾è®¡æ€è·¯" class="headerlink" title="å››ã€æ‰©å±•è®¾è®¡æ€è·¯"></a>å››ã€æ‰©å±•è®¾è®¡æ€è·¯</h3><h4 id="1-ç®—æ³•æ‰©å±•ç‚¹"><a href="#1-ç®—æ³•æ‰©å±•ç‚¹" class="headerlink" title="1. ç®—æ³•æ‰©å±•ç‚¹"></a>1. ç®—æ³•æ‰©å±•ç‚¹</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_hash</span>(<span class="params">file_path, algorithm=<span class="string">&#x27;md5&#x27;</span>, block_size=<span class="number">65536</span></span>):</span><br><span class="line">    hasher = hashlib.new(algorithm)  <span class="comment"># åŠ¨æ€é€‰æ‹©ç®—æ³•</span></span><br><span class="line">    <span class="comment"># ...ç›¸åŒå¤„ç†é€»è¾‘...</span></span><br></pre></td></tr></table></figure>

<h4 id="2-æ€§èƒ½ä¼˜åŒ–æ–¹å‘"><a href="#2-æ€§èƒ½ä¼˜åŒ–æ–¹å‘" class="headerlink" title="2. æ€§èƒ½ä¼˜åŒ–æ–¹å‘"></a>2. æ€§èƒ½ä¼˜åŒ–æ–¹å‘</h4><ul>
<li><strong>å¹¶è¡Œè®¡ç®—</strong>ï¼šä½¿ç”¨<code>concurrent.futures</code>åŠ é€Ÿæ‰¹é‡å¤„ç†</li>
<li><strong>è¿›åº¦æ˜¾ç¤º</strong>ï¼šæ·»åŠ <code>tqdm</code>è¿›åº¦æ¡</li>
</ul>
<h4 id="3-å®‰å…¨å¢å¼º"><a href="#3-å®‰å…¨å¢å¼º" class="headerlink" title="3. å®‰å…¨å¢å¼º"></a>3. å®‰å…¨å¢å¼º</h4><ul>
<li><strong>ç­¾åæ ¡éªŒ</strong>ï¼šæ”¯æŒPGPç­¾åéªŒè¯</li>
<li><strong>å“ˆå¸Œé“¾</strong>ï¼šå®ç°ç±»ä¼¼<code>git</code>çš„å¯¹è±¡å“ˆå¸Œé“¾</li>
</ul>
<h4 id="4-å·¥ç¨‹åŒ–æ”¹è¿›"><a href="#4-å·¥ç¨‹åŒ–æ”¹è¿›" class="headerlink" title="4. å·¥ç¨‹åŒ–æ”¹è¿›"></a>4. å·¥ç¨‹åŒ–æ”¹è¿›</h4><ul>
<li><strong>å•å…ƒæµ‹è¯•</strong>ï¼šé’ˆå¯¹å¤§æ–‡ä»¶&#x2F;ç©ºæ–‡ä»¶&#x2F;éæ³•è·¯å¾„ç­‰è¾¹ç•Œæ¡ä»¶</li>
<li><strong>æ—¥å¿—è®°å½•</strong>ï¼šæ·»åŠ <code>logging</code>æ¨¡å—è®°å½•æ“ä½œ</li>
</ul>
<hr>
<h3 id="äº”ã€è®¾è®¡æƒè¡¡è€ƒé‡"><a href="#äº”ã€è®¾è®¡æƒè¡¡è€ƒé‡" class="headerlink" title="äº”ã€è®¾è®¡æƒè¡¡è€ƒé‡"></a>äº”ã€è®¾è®¡æƒè¡¡è€ƒé‡</h3><ol>
<li><strong>å†…å­˜ vs é€Ÿåº¦</strong>ï¼š<ul>
<li>é€‰æ‹©64KBå—å¤§å°è€Œéä¸€æ¬¡æ€§è¯»å–</li>
<li>ç‰ºç‰²å°‘é‡é€Ÿåº¦æ¢å–å†…å­˜å®‰å…¨æ€§</li>
</ul>
</li>
<li><strong>çµæ´»æ€§ vs å¤æ‚åº¦</strong>ï¼š<ul>
<li>ä¸é»˜è®¤æ”¯æŒå¤šç®—æ³•ä¿æŒç®€å•æ€§</li>
<li>ä½†ä¿ç•™æ‰©å±•æ¥å£</li>
</ul>
</li>
<li><strong>ä¸¥æ ¼æ¨¡å¼å¯é€‰</strong>ï¼š<ul>
<li>å½“å‰å¤§å°å†™ä¸æ•æ„ŸéªŒè¯</li>
<li>å¯æ·»åŠ <code>--strict</code>å‚æ•°å¯ç”¨ä¸¥æ ¼åŒ¹é…</li>
</ul>
</li>
</ol>
<h3 id="å…­ã€æœ€ç»ˆä»£ç å‘ˆç°"><a href="#å…­ã€æœ€ç»ˆä»£ç å‘ˆç°" class="headerlink" title="å…­ã€æœ€ç»ˆä»£ç å‘ˆç°"></a>å…­ã€æœ€ç»ˆä»£ç å‘ˆç°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Dict</span>, <span class="type">List</span>, <span class="type">Optional</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸¸é‡å®šä¹‰</span></span><br><span class="line">DEFAULT_BLOCK_SIZE = <span class="number">65536</span>  <span class="comment"># 64KBå—å¤§å°</span></span><br><span class="line">MD5_FILE_EXTENSION = <span class="string">&#x27;.md5&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_md5</span>(<span class="params">file_path: <span class="built_in">str</span>, block_size: <span class="built_in">int</span> = DEFAULT_BLOCK_SIZE</span>) -&gt; <span class="type">Optional</span>[<span class="built_in">str</span>]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è®¡ç®—æ–‡ä»¶çš„MD5å“ˆå¸Œå€¼</span></span><br><span class="line"><span class="string">    :param file_path: æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="string">    :param block_size: è¯»å–å—å¤§å°(å­—èŠ‚)</span></span><br><span class="line"><span class="string">    :return: MD5å­—ç¬¦ä¸²(å¤±è´¥è¿”å›None)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(file_path):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯: æ–‡ä»¶ä¸å­˜åœ¨ - <span class="subst">&#123;file_path&#125;</span>&quot;</span>, file=sys.stderr)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    md5 = hashlib.md5()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> block <span class="keyword">in</span> <span class="built_in">iter</span>(<span class="keyword">lambda</span>: f.read(block_size), <span class="string">b&#x27;&#x27;</span>):</span><br><span class="line">                md5.update(block)</span><br><span class="line">        <span class="keyword">return</span> md5.hexdigest()</span><br><span class="line">    <span class="keyword">except</span> (IOError, PermissionError) <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯: æ— æ³•è¯»å–æ–‡ä»¶ <span class="subst">&#123;file_path&#125;</span> - <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>, file=sys.stderr)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">batch_calculate_md5</span>(<span class="params">file_list: <span class="type">List</span>[<span class="built_in">str</span>]</span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Optional</span>[<span class="built_in">str</span>]]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ‰¹é‡è®¡ç®—MD5å€¼</span></span><br><span class="line"><span class="string">    :param file_list: æ–‡ä»¶è·¯å¾„åˆ—è¡¨</span></span><br><span class="line"><span class="string">    :return: å­—å…¸&#123;æ–‡ä»¶è·¯å¾„: MD5å€¼&#125;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> &#123;file_path: calculate_md5(file_path) <span class="keyword">for</span> file_path <span class="keyword">in</span> file_list&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify_md5</span>(<span class="params">file_path: <span class="built_in">str</span>, expected_md5: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    éªŒè¯æ–‡ä»¶MD5å€¼</span></span><br><span class="line"><span class="string">    :param file_path: æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="string">    :param expected_md5: é¢„æœŸMD5å€¼</span></span><br><span class="line"><span class="string">    :return: æ˜¯å¦åŒ¹é…</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    actual_md5 = calculate_md5(file_path)</span><br><span class="line">    <span class="keyword">if</span> actual_md5 <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    is_match = actual_md5.lower() == expected_md5.lower()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ–‡ä»¶: <span class="subst">&#123;os.path.abspath(file_path)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;é¢„æœŸMD5: <span class="subst">&#123;expected_md5.lower()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å®é™…MD5: <span class="subst">&#123;actual_md5.lower()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;éªŒè¯ç»“æœ: <span class="subst">&#123;<span class="string">&#x27;åŒ¹é…&#x27;</span> <span class="keyword">if</span> is_match <span class="keyword">else</span> <span class="string">&#x27;ä¸åŒ¹é…&#x27;</span>&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> is_match</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_md5_file</span>(<span class="params">directory: <span class="built_in">str</span>, output_file: <span class="built_in">str</span> = <span class="literal">None</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ç”Ÿæˆç›®å½•çš„MD5æ ¡éªŒæ–‡ä»¶</span></span><br><span class="line"><span class="string">    :param directory: ç›®å½•è·¯å¾„</span></span><br><span class="line"><span class="string">    :param output_file: è¾“å‡ºæ–‡ä»¶è·¯å¾„(é»˜è®¤: ç›®å½•å.md5)</span></span><br><span class="line"><span class="string">    :return: æ˜¯å¦æˆåŠŸ</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isdir(directory):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯: ç›®å½•ä¸å­˜åœ¨ - <span class="subst">&#123;directory&#125;</span>&quot;</span>, file=sys.stderr)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> output_file <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        output_file = os.path.basename(directory.rstrip(<span class="string">&#x27;/\\&#x27;</span>)) + MD5_FILE_EXTENSION</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f_out:</span><br><span class="line">            <span class="keyword">for</span> root, _, files <span class="keyword">in</span> os.walk(directory):</span><br><span class="line">                <span class="keyword">for</span> filename <span class="keyword">in</span> files:</span><br><span class="line">                    file_path = os.path.join(root, filename)</span><br><span class="line">                    md5 = calculate_md5(file_path)</span><br><span class="line">                    <span class="keyword">if</span> md5:</span><br><span class="line">                        relative_path = os.path.relpath(file_path, directory)</span><br><span class="line">                        f_out.write(<span class="string">f&quot;<span class="subst">&#123;md5&#125;</span> *<span class="subst">&#123;relative_path&#125;</span>\n&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æˆåŠŸç”Ÿæˆæ ¡éªŒæ–‡ä»¶: <span class="subst">&#123;os.path.abspath(output_file)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> IOError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯: æ— æ³•å†™å…¥æ ¡éªŒæ–‡ä»¶ - <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>, file=sys.stderr)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify_md5_file</span>(<span class="params">md5_file: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    éªŒè¯MD5æ ¡éªŒæ–‡ä»¶ä¸­çš„æ‰€æœ‰æ¡ç›®</span></span><br><span class="line"><span class="string">    :param md5_file: æ ¡éªŒæ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="string">    :return: æ˜¯å¦å…¨éƒ¨éªŒè¯é€šè¿‡</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(md5_file):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯: æ ¡éªŒæ–‡ä»¶ä¸å­˜åœ¨ - <span class="subst">&#123;md5_file&#125;</span>&quot;</span>, file=sys.stderr)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    all_passed = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(md5_file, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> line_num, line <span class="keyword">in</span> <span class="built_in">enumerate</span>(f, <span class="number">1</span>):</span><br><span class="line">                line = line.strip()</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> line <span class="keyword">or</span> line.startswith(<span class="string">&#x27;#&#x27;</span>):</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># è§£ææ ¼å¼: MD5 *æ–‡ä»¶å æˆ– MD5 æ–‡ä»¶å</span></span><br><span class="line">                parts = line.split(maxsplit=<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(parts) != <span class="number">2</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;è­¦å‘Š: ç¬¬<span class="subst">&#123;line_num&#125;</span>è¡Œæ ¼å¼é”™è¯¯ - <span class="subst">&#123;line&#125;</span>&quot;</span>, file=sys.stderr)</span><br><span class="line">                    all_passed = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                expected_md5, file_path = parts</span><br><span class="line">                <span class="keyword">if</span> file_path.startswith(<span class="string">&#x27;*&#x27;</span>):</span><br><span class="line">                    file_path = file_path[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> verify_md5(file_path, expected_md5):</span><br><span class="line">                    all_passed = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span> IOError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯: è¯»å–æ ¡éªŒæ–‡ä»¶å¤±è´¥ - <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>, file=sys.stderr)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> all_passed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">setup_argparse</span>() -&gt; argparse.ArgumentParser:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;é…ç½®å‘½ä»¤è¡Œå‚æ•°è§£æ&quot;&quot;&quot;</span></span><br><span class="line">    parser = argparse.ArgumentParser(</span><br><span class="line">        description=<span class="string">&#x27;MD5æ ¡éªŒå·¥å…·&#x27;</span>,</span><br><span class="line">        formatter_class=argparse.RawDescriptionHelpFormatter,</span><br><span class="line">        epilog=<span class="string">&quot;&quot;&quot;ä½¿ç”¨ç¤ºä¾‹:</span></span><br><span class="line"><span class="string">  è®¡ç®—MD5:  %(prog)s calc file.txt</span></span><br><span class="line"><span class="string">  éªŒè¯æ–‡ä»¶: %(prog)s verify file.txt d41d8cd98f00b204e9800998ecf8427e</span></span><br><span class="line"><span class="string">  ç”Ÿæˆæ ¡éªŒ: %(prog)s gen ./directory</span></span><br><span class="line"><span class="string">  éªŒè¯æ ¡éªŒ: %(prog)s check checksums.md5&quot;&quot;&quot;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    subparsers = parser.add_subparsers(dest=<span class="string">&#x27;command&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;å­å‘½ä»¤&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># calc å­å‘½ä»¤</span></span><br><span class="line">    calc_parser = subparsers.add_parser(<span class="string">&#x27;calc&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;è®¡ç®—æ–‡ä»¶MD5å€¼&#x27;</span>)</span><br><span class="line">    calc_parser.add_argument(<span class="string">&#x27;file&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;ç›®æ ‡æ–‡ä»¶è·¯å¾„&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># verify å­å‘½ä»¤</span></span><br><span class="line">    verify_parser = subparsers.add_parser(<span class="string">&#x27;verify&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;éªŒè¯æ–‡ä»¶MD5å€¼&#x27;</span>)</span><br><span class="line">    verify_parser.add_argument(<span class="string">&#x27;file&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;è¦éªŒè¯çš„æ–‡ä»¶è·¯å¾„&#x27;</span>)</span><br><span class="line">    verify_parser.add_argument(<span class="string">&#x27;md5&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;é¢„æœŸçš„MD5å€¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># gen å­å‘½ä»¤</span></span><br><span class="line">    gen_parser = subparsers.add_parser(<span class="string">&#x27;gen&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;ç”Ÿæˆç›®å½•çš„MD5æ ¡éªŒæ–‡ä»¶&#x27;</span>)</span><br><span class="line">    gen_parser.add_argument(<span class="string">&#x27;directory&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;ç›®æ ‡ç›®å½•è·¯å¾„&#x27;</span>)</span><br><span class="line">    gen_parser.add_argument(<span class="string">&#x27;-o&#x27;</span>, <span class="string">&#x27;--output&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;è¾“å‡ºæ–‡ä»¶è·¯å¾„&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># check å­å‘½ä»¤</span></span><br><span class="line">    check_parser = subparsers.add_parser(<span class="string">&#x27;check&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;éªŒè¯MD5æ ¡éªŒæ–‡ä»¶&#x27;</span>)</span><br><span class="line">    check_parser.add_argument(<span class="string">&#x27;md5_file&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;MD5æ ¡éªŒæ–‡ä»¶è·¯å¾„&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> parser</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    parser = setup_argparse()</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> args.command == <span class="string">&#x27;calc&#x27;</span>:</span><br><span class="line">        md5 = calculate_md5(args.file)</span><br><span class="line">        <span class="keyword">if</span> md5:</span><br><span class="line">            <span class="built_in">print</span>(md5)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> args.command == <span class="string">&#x27;verify&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> verify_md5(args.file, args.md5):</span><br><span class="line">            sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> args.command == <span class="string">&#x27;gen&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> generate_md5_file(args.directory, args.output):</span><br><span class="line">            sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> args.command == <span class="string">&#x27;check&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> verify_md5_file(args.md5_file):</span><br><span class="line">            sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒæ–‡ç« ï¼š</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lfri/p/12257706.html">MD5æ ¡éªŒç æœ‰ä»€ä¹ˆä½œç”¨</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lfri/p/12257706.html">MD5æ ¡éªŒ </a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_66196770/article/details/140391190">ä¸ºä»€ä¹ˆæ–‡ä»¶éœ€è¦æ ¡éªŒMD5</a></li>
<li><a target="_blank" rel="noopener" href="https://www.sysceo.com/Article-article_info-id-1932.html">å¦‚ä½•ä½¿ç”¨MD5è¿›è¡Œæ–‡ä»¶éªŒè¯</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/lgj123xj/article/details/134725144">ä½¿ç”¨MD5å½“åšæ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†ï¼Œè¿™æ ·å®‰å…¨ä¹ˆï¼Ÿ</a></li>
</ol>
<script src="https://giscus.app/client.js"
        data-repo="fishcanf1y/fishcanf1y.github.io"
        data-repo-id="R_kgDONzaTTQ"
        data-category="Announcements"
        data-category-id="DIC_kwDONzaTTc4Cpqn7"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>
    </div>
    
    <!-- Post Footer -->
    <footer class="post-footer">
        
            <div class="post-updated">
                <small>Last updated: July 12, 2025</small>
            </div>
        
        
        <!-- Post Navigation -->
        <nav class="post-nav">
            
                <div class="post-nav-item post-nav-prev">
                    <a href="/2025/07/11/Linux%E4%B8%8B8086%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="post-nav-link">
                        <span class="post-nav-label">â† Previous</span>
                        <span class="post-nav-title">Linuxä¸‹8086æ±‡ç¼–è¯­è¨€ç¯å¢ƒæ­å»º</span>
                    </a>
                </div>
            
            
            
                <div class="post-nav-item post-nav-next">
                    <a href="/2025/07/11/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-nav-link">
                        <span class="post-nav-label">Next â†’</span>
                        <span class="post-nav-title">GoåŸºç¡€è¯­æ³•å­¦ä¹ ç¬”è®°</span>
                    </a>
                </div>
            
        </nav>
    </footer>
</article>

<!-- Comments Section -->

        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <p>&copy; 2025 zer0ptr. All rights reserved.</p>
                
            </div>
        </footer>
    </div>

    <!-- æŒ‰éœ€åŠ è½½Highlight.js JavaScript -->
    
        <script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script>
            // å»¶è¿ŸåŠ è½½highlight.jsä»¥æé«˜æ€§èƒ½
            function loadHighlight() {
                if (typeof hljs !== 'undefined') {
                    hljs.highlightAll();
                } else {
                    // å¦‚æœhljsè¿˜æœªåŠ è½½ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´åé‡è¯•
                    setTimeout(loadHighlight, 100);
                }
            }
            
            document.addEventListener('DOMContentLoaded', loadHighlight);
            
            // å¦‚æœDOMå·²ç»åŠ è½½å®Œæˆï¼Œç«‹å³æ‰§è¡Œ
            if (document.readyState !== 'loading') {
                loadHighlight();
            }
        </script>
    
    
    <!-- JavaScript -->
    <script defer src="/js/search.js"></script>
    <script defer src="/js/script.js"></script>
</body>
</html>